<html>
<head>
	<title>SyncTab: Login</title>
	<link rel="stylesheet" type="text/css" href="styles.css"/>
	<link href='http://fonts.googleapis.com/css?family=Alike' rel='stylesheet' type='text/css'>

	<script type="text/javascript" src="jquery.min.js"></script>
	<script type="text/javascript">
		$(document).ready(function() {
			var bgPage = chrome.extension.getBackgroundPage();

			if (!bgPage.needLogin()) {
				$('#loginContent').hide();
				$("#loggedInNowContent").hide();
				$('#loggedInAlreadyContent').show();
				$('#username').text(bgPage.getUsername());
			}
			
			$('#loginForm').submit(function() {
				var email = $("#email").val();
				var password = $("#password").val();
				if (email && password) {
					bgPage.authorize2(email, password, function(status) {
						if (status) {
							$("#loginContent").hide();
							$("#loggedInNowContent").show();
						}
						else {
							// TODO - show error
						}
					});
				}
				else {
					// TODO - show error
				}
				return false;
			});

			$('#logout').click(function() {
				bgPage.logout(false);

				$('#loginContent').show();
				$("#loggedInNowContent").hide();
				$('#loggedInAlreadyContent').hide();
			});
		});
	</script>
</head>
<body>
	<div id="content">
		<div id="loginContent">
			<form id="loginForm" action="">
				<h1><span>SyncTab:</span> Login</h1>
				
				<p>
					<label for="email">Your Email</label>
					<input type="text" id="email" value="" maxlength="400" autofocus="true"/>
				</p>

				<p>
					<label for="password">Your Password</label>
					<input type="password" id="password" value="" maxlength="100"/>
				</p>

				<p><input type="submit" id="login" class="mainButton" value="Login"/></p>
				<div class="clear"></div>

				<p style="text-align: right;">Not registered yet? - <a href="register.html">Register Now</a></p>
			</form>
		</div>
		<div id="loggedInNowContent" class="notice" style="display: none">
			<h2><span>SyncTab:</span> Notice</h2>
			<p>
				You are logged in now.
				<a href="javascript:void(0);" onclick="window.close()">Continue Your Work</a>
			</p>
		</div>
		<div id="loggedInAlreadyContent" class="notice" style="display: none">
			<h2><span>SyncTab:</span> Notice</h2>
			<p>
				You are logged in as <span id="username"></a> already.<br/><br/>
				<a href="javascript:void(0);" id="logout">Logout</a> &nbsp;|&nbsp;
				<a href="javascript:void(0);" onclick="window.close()">Close This Window</a>
			</p>
		</div>

		
		<div id="footer">
			<div id="left">Copyright (c) 2011 <a href="http://www.khmelyuk.com">Ruslan Khmelyuk</a></div>
			<div id="right"><a href="http://synctab.khmelyuk.com">synctab.khmelyuk.com</a></div>
			<div class="clear"></div>
		</div>
	</div>
</body>
</html>